{"version":3,"sources":["../../../../server/modules/society/controllers/societyController.js"],"names":["process","env","SECRET_KEY","SocietyController","registerOwner","req","res","societyModel","then","dbResponse","status","satusCode","json","catch","err","console","log","getDetails","getDetailsUsingQueryParam","updatePendingPaymentOfFlat","updatePaymentHistory","reqBody","callback","currentDate","Date","registerBuilding","body","buildingName","societyid","registerSociety","societyName","address","pincode","getOwnerList","societyIds","buildingNames","flatIds","registerFlat","flatName","societyId","deleteRow","tableName","columnName","columnValue","updateBuilding","updateSociety","updateFlat","updateOwner","getDetailsUsingMultiParam","callStoredProc","insertPaymentStructure","totalAmount","buildingMaintenance","parkingMaintenance","municipalDue","sinkingFund","electricityCharge","paymentStructureId","insertId","getFlatIdsByOwnerId","updatedBy","result","ownerId","ids","recieptArray","createPaymentRecieptArray","insertRecieptArray","response","insertPaymentReceipt","innerArray","forEach","element","push","flatid","SocietyModel","blockChain","BlockChain"],"mappings":"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","file":"societyController.js","sourcesContent":["import SocietyModel from './../models/societyModel';\r\nimport BlockChain from './../../blockchain/blockchain'\r\nimport Block from '../../blockchain/block';\r\nprocess.env.SECRET_KEY = 'varunv';\r\n\r\nclass SocietyController {\r\n    constructor(){\r\n         this.societyModel = new SocietyModel();\r\n         this.blockChain = new BlockChain();\r\n    }\r\n\r\n    \r\n    registerOwner= (req, res) =>{\r\n        this.societyModel.registerOwner(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of registerOwner ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n    getDetails= (req, res) =>{\r\n        //console.log('checking auto deploye1111');\r\n        this.societyModel.getDetails(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of getDetails',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n\r\n    // getDetails= (req, res) =>{\r\n    //     console.log('checking auto deploye1111');\r\n    //     this.societyModel.getDetails(req).then((dbResponse)=>{\r\n    //         if(req.params.tableName == 'flat'){\r\n    //             console.log('*****Inside flat table*******');\r\n    //             dbResponse.dbResponse.forEach((element,i) => {\r\n    //                 this.blockChain.addBlock(new Block(i,'12/2/2029',element));\r\n    //                 console.log('wait dude new block is in progress....');\r\n    //             });\r\n                \r\n    //             console.log('is valid',this.blockChain.isChainValid());\r\n    //             this.blockChain.chain[3].data = 'temprored';\r\n    //             console.log('is valid',this.blockChain.isChainValid());\r\n    //             res.status(dbResponse.satusCode).json(this.blockChain);\r\n    //         }\r\n    //       //  res.status(dbResponse.satusCode).json(dbResponse);\r\n    //     }).catch((err)=>{\r\n    //         console.log('catch block of getDetails',err);\r\n    //         res.status(err.satusCode).json(err);\r\n    //     });\r\n    // }\r\n    getDetailsUsingQueryParam= (req, res) =>{\r\n        //console.log(`select * from ${req.params.tableName} where ${req.params.columnName} = ${req.query.value}`);\r\n        this.societyModel.getDetailsUsingQueryParam(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of getDetailsUsingQueryParam',err);\r\n            res.status(err.satusCode).json(err);\r\n        }); \r\n    }\r\n    updatePendingPaymentOfFlat= (req, res) =>{\r\n        //console.log(`update flat set pendingpayment = '${req.body.pendingPayment}' where ownerid =${req.body.ownerid} and flatId =${req.body.flatid};`);\r\n        this.societyModel.updatePendingPaymentOfFlat(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n            // console.log('updatePendingPaymentOfFlat successfully done!!');\r\n            // this.updatePaymentHistory(req, (resFlag, responseData)=>{\r\n            //     if(resFlag){\r\n                    //res.status(dbResponse.satusCode).json(responseData);\r\n                // } else {\r\n                    \r\n                //     res.status(400).json(responseData);\r\n                // }\r\n            //});\r\n        }).catch((err)=>{\r\n            console.log('catch block of updatePendingPaymentOfFlat',err);\r\n            res.status(err.satusCode).json(err);\r\n        }); \r\n    }\r\n\r\n    updatePaymentHistory= (reqBody,callback) =>{\r\n        const currentDate = new Date();\r\n        //console.log(`update paymentHistory set paymentHistory = '${req.body.pendingPayment}' where ownerid =${req.body.ownerid} and flatId =${req.body.flatid};`)\r\n        //console.log(`insert into paymenthistory(flatid,paid,ownerid) values (${reqBody.body.flatid},${reqBody.body.pendingPayment},${reqBody.body.ownerid});`);\r\n        this.societyModel.updatePaymentHistory(reqBody).then((dbResponse)=>{\r\n            callback(true, dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of updatePaymentHistory',err);\r\n            callback(false, err);\r\n        }); \r\n    }\r\n\r\n    registerBuilding = (req, res) => {\r\n        console.log(`insert into building(buildingname, societyid) values\r\n        (${req.body.buildingName},'${req.body.societyid}');`);\r\n        this.societyModel.registerBuilding(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of registerBuilding ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    registerSociety = (req, res) => {\r\n        console.log(`society register query is--- \r\n        insert into society(societyName, address, pincode) values \r\n        ('${req.body.societyName}', '${req.body.address}', '${req.body.pincode}'`);\r\n        this.societyModel.registerSociety(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of registerSociety ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    getOwnerList = (req, res) => {\r\n        console.log(`call get_owner_details(${req.body.societyIds}, ${req.body.buildingNames}, ${req.body.flatIds})`);\r\n        this.societyModel.getOwnerList(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of getOwnerList ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    registerFlat = (req, res) => {\r\n        console.log(`insert into flat(flatname, buildingname, societyid) values ('${req.body.flatName}', '${req.body.buildingName}', ${req.body.societyId});`);\r\n        this.societyModel.registerFlat(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of registerFlat ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n    deleteRow = (req, res) => {\r\n        console.log(`delete from ${req.body.tableName} where ${req.body.columnName} = ${req.body.columnValue}`);\r\n        this.societyModel.deleteRow(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of registerOwner ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    updateBuilding = (req, res) => {\r\n        console.log(`insert into building(buildingname, societyid) values\r\n        (${req.body.buildingName},'${req.body.societyid}');`);\r\n        this.societyModel.updateBuilding(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of updateBuilding ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    updateSociety = (req, res) => {\r\n        console.log(`society register query is--- \r\n        insert into society(societyName, address, pincode) values \r\n        ('${req.body.societyName}', '${req.body.address}', '${req.body.pincode}'`);\r\n        this.societyModel.updateSociety(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of updateSociety ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n    updateFlat = (req, res) => {\r\n        console.log(`insert into flat(flatname, buildingname, societyid) values ('${req.body.flatName}', '${req.body.buildingName}', ${req.body.societyId});`);\r\n        // this.societyModel.updateFlat(req).then((dbResponse)=>{\r\n        //     res.status(dbResponse.satusCode).json(dbResponse);\r\n        // }).catch((err)=>{\r\n        //     console.log('catch block of updateFlat ',err);\r\n        //     res.status(err.satusCode).json(err);\r\n        // });\r\n        res.status(200).json({dbResponse:'need to implement functionality'});\r\n    }\r\n\r\n    updateOwner= (req, res) =>{\r\n        this.societyModel.updateOwner(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of updateOwner ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    getDetailsUsingMultiParam= (req, res) =>{\r\n        this.societyModel.getDetailsUsingMultiParam(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of updateOwner ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    callStoredProc = (req, res)=>{\r\n        this.societyModel.callStoredProc(req).then((dbResponse)=>{\r\n            res.status(dbResponse.satusCode).json(dbResponse);\r\n        }).catch((err)=>{\r\n            console.log('catch block of callStoredProc ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    insertPaymentStructure = async (req, res)=>{\r\n        this.societyModel.insertPaymentStructure(req).then( async (dbResponse)=>{\r\n            let body = req.body;\r\n            let totalAmount = (body.buildingMaintenance||0)+(body.parkingMaintenance||0)+(body.municipalDue||0)+(body.sinkingFund||0)+(body.electricityCharge||0);\r\n            let paymentStructureId = dbResponse.dbResponse.insertId;\r\n            const result = await this.getFlatIdsByOwnerId(req.body.updatedBy, totalAmount, paymentStructureId);\r\n            res.status(dbResponse.satusCode).json(result);\r\n        }).catch((err)=>{\r\n            console.log('catch block of callStoredProc ',err);\r\n            res.status(err.satusCode).json(err);\r\n        });\r\n    }\r\n\r\n    getFlatIdsByOwnerId = async (ownerId, totalAmount, paymentStructureId) =>{\r\n        try {\r\n            let ids= await  this.societyModel.getFlatIdsByOwnerId(ownerId);\r\n            const recieptArray = this.createPaymentRecieptArray(ids, totalAmount, paymentStructureId);\r\n            let response = await this.insertRecieptArray(recieptArray)\r\n            return response;\r\n        } catch(err){\r\n            console.log(err);\r\n            return err;\r\n        }\r\n    }\r\n\r\n    insertRecieptArray = async (recieptArray) =>{\r\n        try {\r\n            let response = await this.societyModel.insertPaymentReceipt(recieptArray);\r\n            response.dbResponse= 'payment Reciept inserted successfully!!';\r\n            return response;\r\n        } catch(err){\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n    createPaymentRecieptArray = (ids, totalAmount, paymentStructureId) =>{\r\n        let recieptArray = [];\r\n        let innerArray;\r\n        ids.dbResponse.forEach((element)=>{\r\n            innerArray=[];\r\n            innerArray.push(element.flatid);\r\n            innerArray.push(totalAmount);\r\n            innerArray.push(paymentStructureId);\r\n            recieptArray.push(innerArray);\r\n        });\r\n        return recieptArray;\r\n    }\r\n\r\n}\r\n\r\nexport default SocietyController;"]}